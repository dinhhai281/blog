<!DOCTYPE html><html lang="vi"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style id="typography.js">html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}article,aside,details,figcaption,figure,footer,header,main,menu,nav,section,summary{display:block}audio,canvas,progress,video{display:inline-block}audio:not([controls]){display:none;height:0}progress{vertical-align:baseline}[hidden],template{display:none}a{background-color:transparent;-webkit-text-decoration-skip:objects}a:active,a:hover{outline-width:0}abbr[title]{border-bottom:none;text-decoration:underline;text-decoration:underline dotted}b,strong{font-weight:inherit;font-weight:bolder}dfn{font-style:italic}h1{font-size:2em;margin:.67em 0}mark{background-color:#ff0;color:#000}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}img{border-style:none}svg:not(:root){overflow:hidden}code,kbd,pre,samp{font-family:monospace,monospace;font-size:1em}figure{margin:1em 40px}hr{box-sizing:content-box;height:0;overflow:visible}button,input,optgroup,select,textarea{font:inherit;margin:0}optgroup{font-weight:700}button,input{overflow:visible}button,select{text-transform:none}[type=reset],[type=submit],button,html [type=button]{-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-cancel-button,[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-input-placeholder{color:inherit;opacity:.54}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}html{font:112.5%/1.61 'Montserrat',sans-serif;box-sizing:border-box;overflow-y:scroll;}*{box-sizing:inherit;}*:before{box-sizing:inherit;}*:after{box-sizing:inherit;}body{color:hsla(0,0%,0%,0.8);font-family:'Montserrat',sans-serif;font-weight:400;word-wrap:break-word;font-kerning:normal;-moz-font-feature-settings:"kern", "liga", "clig", "calt";-ms-font-feature-settings:"kern", "liga", "clig", "calt";-webkit-font-feature-settings:"kern", "liga", "clig", "calt";font-feature-settings:"kern", "liga", "clig", "calt";}img{max-width:100%;margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.61rem;}h1{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.61rem;color:inherit;font-family:'Montserrat',sans-serif;font-weight:700;text-rendering:optimizeLegibility;font-size:1.618rem;line-height:1.1;}h2{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.61rem;color:inherit;font-family:'Montserrat',sans-serif;font-weight:700;text-rendering:optimizeLegibility;font-size:1.33471rem;line-height:1.1;}h3{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.61rem;color:inherit;font-family:'Montserrat',sans-serif;font-weight:700;text-rendering:optimizeLegibility;font-size:1.21225rem;line-height:1.1;}h4{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.61rem;color:inherit;font-family:'Montserrat',sans-serif;font-weight:700;text-rendering:optimizeLegibility;font-size:1rem;line-height:1.1;}h5{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.61rem;color:inherit;font-family:'Montserrat',sans-serif;font-weight:700;text-rendering:optimizeLegibility;font-size:0.90825rem;line-height:1.1;}h6{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.61rem;color:inherit;font-family:'Montserrat',sans-serif;font-weight:700;text-rendering:optimizeLegibility;font-size:0.86558rem;line-height:1.1;}hgroup{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.61rem;}ul{margin-left:1.61rem;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.61rem;list-style-position:outside;list-style-image:none;}ol{margin-left:1.61rem;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.61rem;list-style-position:outside;list-style-image:none;}dl{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.61rem;}dd{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.61rem;}p{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.61rem;}figure{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.61rem;}pre{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.61rem;font-size:0.85rem;line-height:1.61rem;}table{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.61rem;font-size:1rem;line-height:1.61rem;border-collapse:collapse;width:100%;}fieldset{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.61rem;}blockquote{margin-left:1.61rem;margin-right:1.61rem;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.61rem;}form{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.61rem;}noscript{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.61rem;}iframe{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.61rem;}hr{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:calc(1.61rem - 1px);background:hsla(0,0%,0%,0.2);border:none;height:1px;}address{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.61rem;}b{font-weight:700;}strong{font-weight:700;}dt{font-weight:700;}th{font-weight:700;}li{margin-bottom:calc(1.61rem / 2);}ol li{padding-left:0;}ul li{padding-left:0;}li > ol{margin-left:1.61rem;margin-bottom:calc(1.61rem / 2);margin-top:calc(1.61rem / 2);}li > ul{margin-left:1.61rem;margin-bottom:calc(1.61rem / 2);margin-top:calc(1.61rem / 2);}blockquote *:last-child{margin-bottom:0;}li *:last-child{margin-bottom:0;}p *:last-child{margin-bottom:0;}li > p{margin-bottom:calc(1.61rem / 2);}code{font-size:0.85rem;line-height:1.61rem;}kbd{font-size:0.85rem;line-height:1.61rem;}samp{font-size:0.85rem;line-height:1.61rem;}abbr{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;}acronym{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;}abbr[title]{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;text-decoration:none;}thead{text-align:left;}td,th{text-align:left;border-bottom:1px solid hsla(0,0%,0%,0.12);font-feature-settings:"tnum";-moz-font-feature-settings:"tnum";-ms-font-feature-settings:"tnum";-webkit-font-feature-settings:"tnum";padding-left:1.07333rem;padding-right:1.07333rem;padding-top:0.805rem;padding-bottom:calc(0.805rem - 1px);}th:first-child,td:first-child{padding-left:0;}th:last-child,td:last-child{padding-right:0;}</style><style data-href="/blog/styles.e94e0ae38f34fc10ae88.css">/*! normalize.css v8.0.1 | MIT License | github.com/necolas/normalize.css */html{line-height:1.15;-webkit-text-size-adjust:100%}body{margin:0}main{display:block}h1{font-size:2em;margin:.67em 0}hr{box-sizing:content-box;height:0;overflow:visible}pre{font-family:monospace,monospace;font-size:1em}a{background-color:transparent}abbr[title]{border-bottom:none;text-decoration:underline;-webkit-text-decoration:underline dotted;text-decoration:underline dotted}b,strong{font-weight:bolder}code,kbd,samp{font-family:monospace,monospace;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}img{border-style:none}button,input,optgroup,select,textarea{font-family:inherit;font-size:100%;line-height:1.15;margin:0}button,input{overflow:visible}button,select{text-transform:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}fieldset{padding:.35em .75em .625em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}progress{vertical-align:baseline}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}details{display:block}summary{display:list-item}[hidden],template{display:none}blockquote,dd,dl,figure,h1,h2,h3,h4,h5,h6,hr,p,pre{margin:0}button{background-color:transparent;background-image:none}button:focus{outline:1px dotted;outline:5px auto -webkit-focus-ring-color}fieldset,ol,ul{margin:0;padding:0}ol,ul{list-style:none}html{font-family:system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;line-height:1.5}*,:after,:before{box-sizing:border-box;border:0 solid #e2e8f0}hr{border-top-width:1px}img{border-style:solid}textarea{resize:vertical}input::-moz-placeholder,textarea::-moz-placeholder{color:#a0aec0}input:-ms-input-placeholder,textarea:-ms-input-placeholder{color:#a0aec0}input::placeholder,textarea::placeholder{color:#a0aec0}[role=button],button{cursor:pointer}table{border-collapse:collapse}h1,h2,h3,h4,h5,h6{font-size:inherit;font-weight:inherit}a{color:inherit;text-decoration:inherit}button,input,optgroup,select,textarea{padding:0;line-height:inherit;color:inherit}code,kbd,pre,samp{font-family:Menlo,Monaco,Consolas,Liberation Mono,Courier New,monospace}audio,canvas,embed,iframe,img,object,svg,video{display:block;vertical-align:middle}img,video{max-width:100%;height:auto}html{--bg-opacity:1;background-color:#f7fafc;background-color:rgba(247,250,252,var(--bg-opacity))}h4{font-size:1.5rem;--text-opacity:1;color:#b83280;color:rgba(184,50,128,var(--text-opacity));font-weight:500;margin-bottom:1rem}ul>li{list-style:disc;margin:1rem 2rem}code.language-text{padding-left:.5rem!important;padding-right:.5rem!important}p{margin-bottom:1rem}.tag{padding:.25rem .5rem;margin-right:.25rem;margin-bottom:.25rem;--bg-opacity:1;background-color:#d6bcfa;background-color:rgba(214,188,250,var(--bg-opacity));border-radius:.375rem;font-size:.75rem;font-weight:500;--ts-background-color:#007acc;--js-background-color:#f7df1e;--css-background-color:#1572b6;--react-background-color:#61dafb;--angular-background-color:#dd0031;--rxjs-background-color:#d81b60;--rust-background-color:#000;--nodejs-background-color:#393;--graphql-background-color:#e10098;--fb-background-color:#5d4f85}.tag-ts{background-color:var(--ts-background-color);color:#fff;color:rgba(255,255,255,var(--text-opacity))}.tag-js,.tag-ts{--text-opacity:1}.tag-js{background-color:var(--js-background-color);color:#000;color:rgba(0,0,0,var(--text-opacity))}.tag-css{background-color:var(--css-background-color);--text-opacity:1;color:#fff;color:rgba(255,255,255,var(--text-opacity))}.tag-react{background-color:var(--react-background-color);--text-opacity:1;color:#000;color:rgba(0,0,0,var(--text-opacity))}.tag-angular{background-color:var(--angular-background-color)}.tag-angular,.tag-rxjs{--text-opacity:1;color:#fff;color:rgba(255,255,255,var(--text-opacity))}.tag-rxjs{background-color:var(--rxjs-background-color)}.tag-rust{background-color:var(--rust-background-color)}.tag-nodejs,.tag-rust{--text-opacity:1;color:#fff;color:rgba(255,255,255,var(--text-opacity))}.tag-nodejs{background-color:var(--nodejs-background-color)}.tag-graphql{background-color:var(--graphql-background-color)}.tag-fp,.tag-graphql{--text-opacity:1;color:#fff;color:rgba(255,255,255,var(--text-opacity))}.tag-fp{background-color:var(--fb-background-color)}.container{width:100%}@media (min-width:640px){.container{max-width:640px}}@media (min-width:768px){.container{max-width:768px}}@media (min-width:1024px){.container{max-width:1024px}}@media (min-width:1280px){.container{max-width:1280px}}.rounded-full{border-radius:9999px}.cursor-pointer{cursor:pointer}.flex{display:flex}.table{display:table}.grid{display:grid}.flex-row{flex-direction:row}.flex-col{flex-direction:column}.flex-wrap{flex-wrap:wrap}.items-center{align-items:center}.justify-between{justify-content:space-between}.font-semibold{font-weight:600}.font-bold{font-weight:700}.h-10{height:2.5rem}.text-xs{font-size:.75rem}.text-sm{font-size:.875rem}.text-xl{font-size:1.25rem}.text-2xl{font-size:1.5rem}.text-3xl{font-size:1.875rem}.leading-10{line-height:2.5rem}.m-0{margin:0}.mx-1{margin-left:.25rem;margin-right:.25rem}.mx-auto{margin-left:auto;margin-right:auto}.mb-2{margin-bottom:.5rem}.mr-3{margin-right:.75rem}.mt-6{margin-top:1.5rem}.mb-6{margin-bottom:1.5rem}.mb-8{margin-bottom:2rem}.mb-12{margin-bottom:3rem}.p-0{padding:0}.px-8{padding-left:2rem;padding-right:2rem}.pt-1{padding-top:.25rem}.pr-2{padding-right:.5rem}.pl-2{padding-left:.5rem}.pt-6{padding-top:1.5rem}.pb-24{padding-bottom:6rem}.text-pink-700{--text-opacity:1;color:#b83280;color:rgba(184,50,128,var(--text-opacity))}.text-opacity-75{--text-opacity:0.75}.underline{text-decoration:underline}.w-10{width:2.5rem}.grid-cols-1{grid-template-columns:repeat(1,minmax(0,1fr))}.grid-rows-2{grid-template-rows:repeat(2,minmax(0,1fr))}@-webkit-keyframes spin{to{transform:rotate(1turn)}}@keyframes spin{to{transform:rotate(1turn)}}@-webkit-keyframes ping{75%,to{transform:scale(2);opacity:0}}@keyframes ping{75%,to{transform:scale(2);opacity:0}}@-webkit-keyframes pulse{50%{opacity:.5}}@keyframes pulse{50%{opacity:.5}}@-webkit-keyframes bounce{0%,to{transform:translateY(-25%);-webkit-animation-timing-function:cubic-bezier(.8,0,1,1);animation-timing-function:cubic-bezier(.8,0,1,1)}50%{transform:none;-webkit-animation-timing-function:cubic-bezier(0,0,.2,1);animation-timing-function:cubic-bezier(0,0,.2,1)}}@keyframes bounce{0%,to{transform:translateY(-25%);-webkit-animation-timing-function:cubic-bezier(.8,0,1,1);animation-timing-function:cubic-bezier(.8,0,1,1)}50%{transform:none;-webkit-animation-timing-function:cubic-bezier(0,0,.2,1);animation-timing-function:cubic-bezier(0,0,.2,1)}}@media (min-width:640px){.sm\:container{width:100%;max-width:640px}@media (min-width:768px){.sm\:container{max-width:768px}}@media (min-width:1024px){.sm\:container{max-width:1024px}}@media (min-width:1280px){.sm\:container{max-width:1280px}}.sm\:mb-1{margin-bottom:.25rem}}@media (min-width:768px){.md\:container{width:100%}@media (min-width:640px){.md\:container{max-width:640px}}@media (min-width:768px){.md\:container{max-width:768px}}@media (min-width:1024px){.md\:container{max-width:1024px}}@media (min-width:1280px){.md\:container{max-width:1280px}}.md\:h-12{height:3rem}.md\:text-sm{font-size:.875rem}.md\:text-2xl{font-size:1.5rem}.md\:text-3xl{font-size:1.875rem}.md\:text-4xl{font-size:2.25rem}.md\:mb-10{margin-bottom:2.5rem}.md\:px-16{padding-left:4rem;padding-right:4rem}.md\:pt-10{padding-top:2.5rem}.md\:w-12{width:3rem}}@media (min-width:1024px){.lg\:container{width:100%}@media (min-width:640px){.lg\:container{max-width:640px}}@media (min-width:768px){.lg\:container{max-width:768px}}@media (min-width:1024px){.lg\:container{max-width:1024px}}@media (min-width:1280px){.lg\:container{max-width:1280px}}.lg\:text-4xl{font-size:2.25rem}.lg\:text-5xl{font-size:3rem}.lg\:mb-12{margin-bottom:3rem}.lg\:px-32{padding-left:8rem;padding-right:8rem}.lg\:pt-12{padding-top:3rem}}@media (min-width:1280px){.xl\:container{width:100%}@media (min-width:640px){.xl\:container{max-width:640px}}@media (min-width:768px){.xl\:container{max-width:768px}}@media (min-width:1024px){.xl\:container{max-width:1024px}}@media (min-width:1280px){.xl\:container{max-width:1280px}}}code[class*=language-],pre[class*=language-]{color:#f8f8f2;background:none;text-shadow:0 1px rgba(0,0,0,.3);font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none}pre[class*=language-]{padding:1em;margin:.5em 0;overflow:auto;border-radius:.3em}:not(pre)>code[class*=language-],pre[class*=language-]{background:#272822}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em;white-space:normal}.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#8292a2}.token.punctuation{color:#f8f8f2}.token.namespace{opacity:.7}.token.constant,.token.deleted,.token.property,.token.symbol,.token.tag{color:#f92672}.token.boolean,.token.number{color:#ae81ff}.token.attr-name,.token.builtin,.token.char,.token.inserted,.token.selector,.token.string{color:#a6e22e}.language-css .token.string,.style .token.string,.token.entity,.token.operator,.token.url,.token.variable{color:#f8f8f2}.token.atrule,.token.attr-value,.token.class-name,.token.function{color:#e6db74}.token.keyword{color:#66d9ef}.token.important,.token.regex{color:#fd971f}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}</style><meta name="generator" content="Gatsby 2.24.66"/><title data-react-helmet="true">State Management Trong Angular Với NgRx | Góc Sáng</title><meta data-react-helmet="true" name="description" content="Personal blog by Hai Nguyen"/><meta data-react-helmet="true" name="keywords" content="Blog,React,Angular,Javascript,Typescript,Functional Programming"/><meta data-react-helmet="true" property="og:title" content="State Management Trong Angular Với NgRx"/><meta data-react-helmet="true" property="og:type" content="website"/><link href="//fonts.googleapis.com/css?family=Montserrat:400,700" rel="stylesheet" type="text/css"/><link as="script" rel="preload" href="/blog/webpack-runtime-c68adcef32857bd97904.js"/><link as="script" rel="preload" href="/blog/styles-8fab2804fb6f85b824b6.js"/><link as="script" rel="preload" href="/blog/framework-d066f55745d479a55fde.js"/><link as="script" rel="preload" href="/blog/app-a42c45a4b4da4c1b5731.js"/><link as="script" rel="preload" href="/blog/022d3153bf09c36cd784dcdb36ffbd187f9c96d7-ab1bc4163aea950f629a.js"/><link as="script" rel="preload" href="/blog/component---src-templates-blog-post-tsx-b4aef0ee06d6dd6721d3.js"/><link as="fetch" rel="preload" href="/blog/page-data/en/state-management-with-ngrx-in-angular/page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/blog/page-data/sq/d/634353619.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/blog/page-data/sq/d/821159082.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/blog/page-data/app-data.json" crossorigin="anonymous"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div class="container pt-6 md:pt-10 lg:pt-12 px-8 md:px-16 lg:px-32 mx-auto"><header class="flex justify-between items-center mb-6 md:mb-10 lg:mb-12"><h1 class="text-pink-700 text-3xl md:text-4xl lg:text-5xl font-bold leading-10"><a role="link" href="/blog/en/">Góc Sáng</a></h1></header><main role="main"><div class="pb-24"><header><h1 data-testid="title" class="mb-12 text-2xl md:text-3xl lg:text-4xl text-pink-700 font-semibold">State Management Trong Angular Với NgRx</h1><div class="mb-8 mx-1 gatsby-image-wrapper" style="position:relative;overflow:hidden"><div aria-hidden="true" style="width:100%;padding-bottom:48.148148148148145%"></div><img aria-hidden="true" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAIAAAA7N+mxAAAACXBIWXMAAAsSAAALEgHS3X78AAABLElEQVQoz6WQTUvDQBCG8zs8ihSlH7s7s5vNJmkNScyHgYKxCh5q6b1+HARPVryJ4MGTF3+s020JJVUQHBZ2Z3aed+ddB/4RznoTNnbP28E5b9U3sJTSMxoR6VYqpbVGwBZsPONpb5t3qIlS3/hlUbnKJfnjIIzjhIGQxIvVJLZHpGWa5AlVKLXSSLCkiXwZx+pCoVGAz53br727fDAcADfaI11SjEbRi3l/yJ6iJBJcNDBKkJl/VQXzoTkb99OP/ftJr5iw+rB3NJvOFoubbr9bhtVb+LksXvOoYJxJgixMT6tIjxPvfOSe0iCPnXp5cJ3xjAPXSpNPFKhcWceX05M5fUczuWM3WL+/8gbAEAKuyStuPIM9kALnyFqecXcJgB/qQpJAk/4K/3F9A5ecgZ+tqZuKAAAAAElFTkSuQmCC" alt="featured-img" style="position:absolute;top:0;left:0;width:100%;height:100%;object-fit:cover;object-position:center;opacity:1;transition-delay:500ms"/><noscript><picture><source srcset="/blog/static/87ffd824dd8c7491b87410f85f57d6cb/5ca18/ngrx-featured.png 270w,
/blog/static/87ffd824dd8c7491b87410f85f57d6cb/13528/ngrx-featured.png 540w,
/blog/static/87ffd824dd8c7491b87410f85f57d6cb/05d05/ngrx-featured.png 1080w,
/blog/static/87ffd824dd8c7491b87410f85f57d6cb/a481c/ngrx-featured.png 1087w" sizes="(max-width: 1080px) 100vw, 1080px" /><img loading="lazy" sizes="(max-width: 1080px) 100vw, 1080px" srcset="/blog/static/87ffd824dd8c7491b87410f85f57d6cb/5ca18/ngrx-featured.png 270w,
/blog/static/87ffd824dd8c7491b87410f85f57d6cb/13528/ngrx-featured.png 540w,
/blog/static/87ffd824dd8c7491b87410f85f57d6cb/05d05/ngrx-featured.png 1080w,
/blog/static/87ffd824dd8c7491b87410f85f57d6cb/a481c/ngrx-featured.png 1087w" src="/blog/static/87ffd824dd8c7491b87410f85f57d6cb/05d05/ngrx-featured.png" alt="featured-img" style="position:absolute;top:0;left:0;opacity:1;width:100%;height:100%;object-fit:cover;object-position:center"/></picture></noscript></div></header><div data-testid="post-content"><p>State Management hay quản lý state là một khái niệm khá phổ biến ở React và Angular cũng đã có một sự giao lưu tuyệt vời với nó qua NgRx - Reactive State for Angular. Bài viết này mình sẽ chia sẽ về cách tổ chức state của mình khi sử dụng NgRx.</p>
<h4>State là gì?</h4>
<p>Với những ai đã từng sử dụng qua React thì state và props là 2 khái niệm đã quá quen thuộc, nhưng nếu bạn chỉ biết đến Angular thì có thể sẽ không biết đến nó dù bạn vẫn dùng nó mỗi ngày.</p>
<p><strong>State:</strong> Là những thứ được quản lý bên trong component ví dụ bạn có một property để lưu lại một giá trị thì nó có thể được gọi là state. Trong React mỗi khi state thay đổi thì component sẽ re-render. Còn trong Angular thì tuỳ trường hợp mà có thể khi bạn thay đổi state thì component sẽ không re-render. Đề có được cơ chế re-render tương tự trong Angular thì thay vì sử dụng dùng một biến kiểu string để lưu một chuỗi và mutate nó mỗi khi cần thay đổi thì hãy dùng BehaviorSubject và next giá trị mới khi cần thay đổi và async pipe để hiển thị giá trị đó ra ngoài.</p>
<p>Việc có thể sử dụng RxJS để tạo ra "State" đã làm cho sự khác biệt về React và Angular không còn quá lớn. Rất nhiều những kỹ thuật được dùng trong React có thể được áp dụng trong Angular và ngược lại. Trong đó <strong>Flux Architect</strong> là một trong những thứ rất đáng học hỏi để tạo ra những web application có khả năng scale tốt hơn.</p>
<h4>NgRx - Reactive State cho Angular</h4>
<p><code class="language-text">Redux</code> là một state management library cực kỳ phổ biến trong cộng đồng React cho việc quản lý state theo Flux Architect và <code class="language-text">NgRx</code> được truyền cảm hứng dựa trên Redux để giải quyết vấn đề tương tự cho Angular.</p>
<p>So với Redux thì có thể nói NgRx hoàn thiện hơn rất nhiều và đúng với phong cách của Angular nó có đầy đủ các món ăn chơi để có thể giải quyết mọi vấn đề mà một developer phải đối mặt khi sử dụng state management library.</p>
<p>Khác với Redux, để sử dụng tốt NgRx thì phải có một sự hiểu biết tương đối về Reactive Programming vì state trong NgRx là Reactive State - <strong>Everything is stream</strong> -</p>
<p><strong>Giới thiệu vậy thôi chứ bài viết này không nhằm mục đích hướng dẫn sử dụng NgRx nên sẽ không hướng dẫn xài cái này đâu nha.</strong></p>
<h4>Store module</h4>
<p>Việc sử dụng NgRx không có nghĩa là sẽ bỏ qua hoàn toàn local state, chỉ những thứ cần thiết mới nên được lưu trên store. Store này mình thường tách thành một module riêng trong đó sẽ có nhiều store feature module.</p>
<p>Store module này sẽ được import vào AppModule, đồng nghĩa mình sẽ không lazy load store module này. Store module với toàn bộ state sẽ được load ngay từ đầu cho dù có thể feature sử dụng nó có lazy load đi nữa.</p>
<p>Tất nhiên nếu bundle size là một trong những yếu tố quan trọng với project của bạn thì cái store feature module cũng có thể được lazy load nhưng hãy chú ý về những gì store feature module đó có nhé.</p>
<p>Trong Store module này thường sẽ không có gì cả, đây chỉ là nơi để setup NgRx và import các store feature module.</p>
<p><strong>store/store.module.ts</strong></p>
<div class="gatsby-highlight" data-language="typescript"><pre class="language-typescript"><code class="language-typescript"><span class="token keyword">import</span> <span class="token punctuation">{</span> CommonModule <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@angular/common'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> NgModule <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@angular/core'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> EffectsModule <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@ngrx/effects'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> StoreModule <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@ngrx/store'</span><span class="token punctuation">;</span>

@<span class="token function">NgModule</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  declarations<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  imports<span class="token operator">:</span> <span class="token punctuation">[</span>
    CommonModule<span class="token punctuation">,</span>
    StoreModule<span class="token punctuation">.</span><span class="token function">forRoot</span><span class="token punctuation">(</span>
      <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        runtimeChecks<span class="token operator">:</span> <span class="token punctuation">{</span>
          strictActionImmutability<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
          strictStateSerializability<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
          strictActionSerializability<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
          strictStateImmutability<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
          strictActionTypeUniqueness<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">)</span><span class="token punctuation">,</span>
    EffectsModule<span class="token punctuation">.</span><span class="token function">forRoot</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    environment<span class="token punctuation">.</span>storeInstrument<span class="token punctuation">,</span>
    PostFeatureStoreModule<span class="token punctuation">,</span>
    AuthFeatureStoreModule<span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">AppStoreModule</span> <span class="token punctuation">{</span><span class="token punctuation">}</span></code></pre></div>
<p><strong>store/reducer.ts</strong></p>
<div class="gatsby-highlight" data-language="typescript"><pre class="language-typescript"><code class="language-typescript"><span class="token keyword">export</span> <span class="token keyword">interface</span> <span class="token class-name">State</span> <span class="token punctuation">{</span><span class="token punctuation">}</span></code></pre></div>
<h4>Store Feature Module</h4>
<p>Khi cần quản lý một thứ gì đó bằng store thì hãy tách nó thành một Store Feature Module sau đó import ngược lại vào Store Module. Như vậy sẽ dễ hơn trong việc tổ chức code và những logic về một loại state nào đó sẽ được tách biệt.</p>
<p>Ví dụ trong app có một feature là login thì hãy tạo một <code class="language-text">AuthFeatureStoreModule</code>, trong đó có đầy đủ các action, reducer, selector, effects để bạn có thể xử lý mọi logic có thể xảy ra với việc login.</p>
<p><strong>store/auth/auth.reducer.ts</strong></p>
<div class="gatsby-highlight" data-language="typescript"><pre class="language-typescript"><code class="language-typescript"><span class="token keyword">import</span> <span class="token punctuation">{</span> User <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@app/models'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Action<span class="token punctuation">,</span> createReducer<span class="token punctuation">,</span> on <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@ngrx/store'</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token punctuation">{</span> login<span class="token punctuation">,</span> loginFailure<span class="token punctuation">,</span> loginSuccess <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./auth.action'</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token constant">AUTH_FEATURE_KEY</span> <span class="token operator">=</span> <span class="token string">'auth'</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">interface</span> <span class="token class-name">AuthState</span> <span class="token punctuation">{</span>
  me<span class="token operator">:</span> User<span class="token punctuation">;</span>
  token<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  loading<span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">;</span>
  error<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> initialState<span class="token operator">:</span> AuthState <span class="token operator">=</span> <span class="token punctuation">{</span>
  me<span class="token operator">:</span> <span class="token keyword">undefined</span><span class="token punctuation">,</span>
  token<span class="token operator">:</span> <span class="token keyword">undefined</span><span class="token punctuation">,</span>
  loading<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  error<span class="token operator">:</span> <span class="token keyword">undefined</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> _authReducer <span class="token operator">=</span> <span class="token function">createReducer</span><span class="token punctuation">(</span>
  initialState<span class="token punctuation">,</span>
  <span class="token function">on</span><span class="token punctuation">(</span>login<span class="token punctuation">,</span> state <span class="token operator">=></span> <span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token operator">...</span>state<span class="token punctuation">,</span> loading<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token function">on</span><span class="token punctuation">(</span>loginSuccess<span class="token punctuation">,</span> <span class="token punctuation">(</span>state<span class="token punctuation">,</span> <span class="token punctuation">{</span> user<span class="token punctuation">,</span> token <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token operator">...</span>state<span class="token punctuation">,</span> loading<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> user<span class="token punctuation">,</span> token <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token function">on</span><span class="token punctuation">(</span>loginFailure<span class="token punctuation">,</span> <span class="token punctuation">(</span>state<span class="token punctuation">,</span> <span class="token punctuation">{</span> error <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token operator">...</span>state<span class="token punctuation">,</span> loading<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> error <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">reducer</span><span class="token punctuation">(</span>state<span class="token operator">:</span> AuthState <span class="token operator">|</span> <span class="token keyword">undefined</span><span class="token punctuation">,</span> action<span class="token operator">:</span> Action<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token function">_authReducer</span><span class="token punctuation">(</span>state<span class="token punctuation">,</span> action<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></div>
<br>
<p><strong>store/auth/auth.action.ts</strong></p>
<div class="gatsby-highlight" data-language="typescript"><pre class="language-typescript"><code class="language-typescript"><span class="token keyword">import</span> <span class="token punctuation">{</span> User <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@app/models'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> createAction<span class="token punctuation">,</span> props <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@ngrx/store'</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> login <span class="token operator">=</span> <span class="token function">createAction</span><span class="token punctuation">(</span><span class="token string">'[Auth] Login'</span><span class="token punctuation">,</span> <span class="token generic-function"><span class="token function">props</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token punctuation">{</span> email<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span> password<span class="token operator">:</span> <span class="token builtin">string</span> <span class="token punctuation">}</span><span class="token operator">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> loginSuccess <span class="token operator">=</span> <span class="token function">createAction</span><span class="token punctuation">(</span>
  <span class="token string">'[Auth] Login__SUCCESS'</span><span class="token punctuation">,</span>
  <span class="token generic-function"><span class="token function">props</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token punctuation">{</span> user<span class="token operator">:</span> User<span class="token punctuation">;</span> token<span class="token operator">:</span> <span class="token builtin">string</span> <span class="token punctuation">}</span><span class="token operator">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> loginFailure <span class="token operator">=</span> <span class="token function">createAction</span><span class="token punctuation">(</span><span class="token string">'[Auth] Login__FAILURE'</span><span class="token punctuation">,</span> <span class="token generic-function"><span class="token function">props</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token punctuation">{</span> error<span class="token operator">:</span> <span class="token builtin">string</span> <span class="token punctuation">}</span><span class="token operator">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<br>
<p><strong>store/auth/auth.selector.ts</strong></p>
<div class="gatsby-highlight" data-language="typescript"><pre class="language-typescript"><code class="language-typescript"><span class="token keyword">import</span> <span class="token punctuation">{</span> createFeatureSelector<span class="token punctuation">,</span> createSelector <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@ngrx/store'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> AuthState<span class="token punctuation">,</span> <span class="token constant">AUTH_FEATURE_KEY</span> <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./auth.reducer'</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> selectAuthState <span class="token operator">=</span> <span class="token generic-function"><span class="token function">createFeatureSelector</span><span class="token generic class-name"><span class="token operator">&lt;</span>AuthState<span class="token operator">></span></span></span><span class="token punctuation">(</span><span class="token constant">AUTH_FEATURE_KEY</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> selectToken <span class="token operator">=</span> <span class="token function">createSelector</span><span class="token punctuation">(</span>selectAuthState<span class="token punctuation">,</span> state <span class="token operator">=></span> state<span class="token punctuation">.</span>token<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> selectMe <span class="token operator">=</span> <span class="token function">createSelector</span><span class="token punctuation">(</span>selectAuthState<span class="token punctuation">,</span> state <span class="token operator">=></span> state<span class="token punctuation">.</span>me<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> selectLoading <span class="token operator">=</span> <span class="token function">createSelector</span><span class="token punctuation">(</span>selectAuthState<span class="token punctuation">,</span> state <span class="token operator">=></span> state<span class="token punctuation">.</span>loading<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> selectIsLoggedIn <span class="token operator">=</span> <span class="token function">createSelector</span><span class="token punctuation">(</span>
  selectToken<span class="token punctuation">,</span>
  selectLoading<span class="token punctuation">,</span>
  <span class="token punctuation">(</span>token<span class="token punctuation">,</span> loading<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token operator">!</span><span class="token operator">!</span>token <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>loading<span class="token punctuation">,</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<br>
<p><strong>store/auth/auth.effect.ts</strong></p>
<div class="gatsby-highlight" data-language="typescript"><pre class="language-typescript"><code class="language-typescript"><span class="token keyword">import</span> <span class="token punctuation">{</span> Injectable <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@angular/core'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Router <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@angular/router'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> AuthService <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@app/services/auth.service'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Actions<span class="token punctuation">,</span> createEffect<span class="token punctuation">,</span> ofType <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@ngrx/effects'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> <span class="token keyword">of</span> <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'rxjs'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> catchError<span class="token punctuation">,</span> exhaustMap<span class="token punctuation">,</span> map<span class="token punctuation">,</span> tap <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'rxjs/operators'</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token punctuation">{</span> login<span class="token punctuation">,</span> loginFailure<span class="token punctuation">,</span> loginSuccess <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./auth.action'</span><span class="token punctuation">;</span>

@<span class="token function">Injectable</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">AuthEffects</span> <span class="token punctuation">{</span>
  loginEffect$ <span class="token operator">=</span> <span class="token function">createEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>action$<span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>
      <span class="token function">ofType</span><span class="token punctuation">(</span>login<span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token function">exhaustMap</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">{</span> email<span class="token punctuation">,</span> password <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=></span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>authService<span class="token punctuation">.</span><span class="token function">loginWithLocal</span><span class="token punctuation">(</span>email<span class="token punctuation">,</span> password<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>
          <span class="token function">map</span><span class="token punctuation">(</span>response <span class="token operator">=></span> <span class="token function">loginSuccess</span><span class="token punctuation">(</span><span class="token punctuation">{</span> user<span class="token operator">:</span> response<span class="token punctuation">.</span>user<span class="token punctuation">,</span> token<span class="token operator">:</span> response<span class="token punctuation">.</span>token <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
          <span class="token function">catchError</span><span class="token punctuation">(</span>err <span class="token operator">=></span> <span class="token keyword">of</span><span class="token punctuation">(</span><span class="token function">loginFailure</span><span class="token punctuation">(</span><span class="token punctuation">{</span> error<span class="token operator">:</span> err <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>

  loginSuccessEffect$ <span class="token operator">=</span> <span class="token function">createEffect</span><span class="token punctuation">(</span>
    <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>action$<span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>
        <span class="token function">ofType</span><span class="token punctuation">(</span>loginSuccess<span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token function">tap</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token keyword">this</span><span class="token punctuation">.</span>router<span class="token punctuation">.</span><span class="token function">navigate</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'/posts'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
      dispatch<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">constructor</span><span class="token punctuation">(</span>
    <span class="token keyword">private</span> <span class="token keyword">readonly</span> action$<span class="token operator">:</span> Actions<span class="token punctuation">,</span>
    <span class="token keyword">private</span> <span class="token keyword">readonly</span> authService<span class="token operator">:</span> AuthService<span class="token punctuation">,</span>
    <span class="token keyword">private</span> <span class="token keyword">readonly</span> router<span class="token operator">:</span> Router<span class="token punctuation">,</span>
  <span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div>
<br>
<p><strong>store/auth/auth.module.ts</strong></p>
<div class="gatsby-highlight" data-language="typescript"><pre class="language-typescript"><code class="language-typescript"><span class="token keyword">import</span> <span class="token punctuation">{</span> NgModule <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@angular/core'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> CommonModule <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@angular/common'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> StoreModule <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@ngrx/store'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> <span class="token constant">AUTH_FEATURE_KEY</span><span class="token punctuation">,</span> reducer <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./auth.reducer'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> EffectsModule <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@ngrx/effects'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> AuthEffects <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./auth.effect'</span><span class="token punctuation">;</span>

@<span class="token function">NgModule</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  imports<span class="token operator">:</span> <span class="token punctuation">[</span>
    CommonModule<span class="token punctuation">,</span>
    StoreModule<span class="token punctuation">.</span><span class="token function">forFeature</span><span class="token punctuation">(</span><span class="token constant">AUTH_FEATURE_KEY</span><span class="token punctuation">,</span> reducer<span class="token punctuation">)</span><span class="token punctuation">,</span>
    EffectsModule<span class="token punctuation">.</span><span class="token function">forFeature</span><span class="token punctuation">(</span><span class="token punctuation">[</span>AuthEffects<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">AuthFeatureStoreModule</span> <span class="token punctuation">{</span><span class="token punctuation">}</span></code></pre></div>
<br>
<p><strong>store/auth/index.ts</strong></p>
<div class="gatsby-highlight" data-language="typescript"><pre class="language-typescript"><code class="language-typescript"><span class="token keyword">export</span> <span class="token operator">*</span> <span class="token keyword">from</span> <span class="token string">'./auth.action'</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token operator">*</span> <span class="token keyword">from</span> <span class="token string">'./auth.reducer'</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token operator">*</span> <span class="token keyword">from</span> <span class="token string">'./auth.selector'</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token operator">*</span> <span class="token keyword">from</span> <span class="token string">'./auth.effect'</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token operator">*</span> <span class="token keyword">from</span> <span class="token string">'./auth.module'</span><span class="token punctuation">;</span></code></pre></div>
<p><strong>store/reducer.ts</strong></p>
<div class="gatsby-highlight" data-language="typescript"><pre class="language-typescript"><code class="language-typescript"><span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> fromAuth <span class="token keyword">from</span> <span class="token string">'@store/application/auth'</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">interface</span> <span class="token class-name">State</span> <span class="token punctuation">{</span>
  <span class="token punctuation">[</span>fromAuth<span class="token punctuation">.</span><span class="token constant">AUTH_FEATURE_KEY</span><span class="token punctuation">]</span><span class="token operator">:</span> fromAuth<span class="token punctuation">.</span>AuthState<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token punctuation">{</span> fromPost<span class="token punctuation">,</span> fromAuth <span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre></div>
<br>
<p><strong>store/store.module.ts</strong></p>
<div class="gatsby-highlight" data-language="typescript"><pre class="language-typescript"><code class="language-typescript"><span class="token keyword">import</span> <span class="token punctuation">{</span> CommonModule <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@angular/common'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> NgModule <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@angular/core'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> EffectsModule <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@ngrx/effects'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> StoreModule <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@ngrx/store'</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token punctuation">{</span> AuthFeatureStoreModule <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./application/auth'</span><span class="token punctuation">;</span>

@<span class="token function">NgModule</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  declarations<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  imports<span class="token operator">:</span> <span class="token punctuation">[</span>
    CommonModule<span class="token punctuation">,</span>
    StoreModule<span class="token punctuation">.</span><span class="token function">forRoot</span><span class="token punctuation">(</span>
      <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        runtimeChecks<span class="token operator">:</span> <span class="token punctuation">{</span>
          strictActionImmutability<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
          strictStateSerializability<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
          strictActionSerializability<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
          strictStateImmutability<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
          strictActionTypeUniqueness<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">)</span><span class="token punctuation">,</span>
    EffectsModule<span class="token punctuation">.</span><span class="token function">forRoot</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    AuthFeatureStoreModule<span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">AppStoreModule</span> <span class="token punctuation">{</span><span class="token punctuation">}</span></code></pre></div>
<h4>Store Entity Feature Module</h4>
<p>Nếu state đó có dạng một list các item hoặc bị lồng vào nhau hãy tham khảo thử bài viết này <a href="https://redux.js.org/recipes/structuring-reducers/normalizing-state-shape">https://redux.js.org/recipes/structuring-reducers/normalizing-state-shape</a>. Trong NgRx có<code class="language-text">@ngrx/entity</code> sẽ hỗ trợ việc đó một cách nhanh chóng.</p>
<p><strong>store/post/post.reducer.ts</strong></p>
<div class="gatsby-highlight" data-language="typescript"><pre class="language-typescript"><code class="language-typescript"><span class="token keyword">import</span> <span class="token punctuation">{</span> createEntityAdapter<span class="token punctuation">,</span> EntityAdapter<span class="token punctuation">,</span> EntityState <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@ngrx/entity'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Action<span class="token punctuation">,</span> createReducer<span class="token punctuation">,</span> on <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@ngrx/store'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Post <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@app/models'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> loadPosts<span class="token punctuation">,</span> selectPost <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./post.action'</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token constant">POST_FEATURE_KEY</span> <span class="token operator">=</span> <span class="token string">'posts'</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> adapter<span class="token operator">:</span> EntityAdapter<span class="token operator">&lt;</span>Post<span class="token operator">></span> <span class="token operator">=</span> <span class="token generic-function"><span class="token function">createEntityAdapter</span><span class="token generic class-name"><span class="token operator">&lt;</span>Post<span class="token operator">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">interface</span> <span class="token class-name">PostEntityState</span> <span class="token keyword">extends</span> <span class="token class-name">EntityState<span class="token operator">&lt;</span>Post<span class="token operator">></span></span> <span class="token punctuation">{</span>
  selectedPostId<span class="token operator">:</span> <span class="token builtin">number</span> <span class="token operator">|</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> initialState<span class="token operator">:</span> PostEntityState <span class="token operator">=</span> adapter<span class="token punctuation">.</span><span class="token function">getInitialState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  selectedPostId<span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> _postReducer <span class="token operator">=</span> <span class="token function">createReducer</span><span class="token punctuation">(</span>
  initialState<span class="token punctuation">,</span>
  <span class="token function">on</span><span class="token punctuation">(</span>selectPost<span class="token punctuation">,</span> <span class="token punctuation">(</span>state<span class="token punctuation">,</span> <span class="token punctuation">{</span> id <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token operator">...</span>state<span class="token punctuation">,</span> selectedPostId<span class="token operator">:</span> id <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token function">on</span><span class="token punctuation">(</span>loadPosts<span class="token punctuation">,</span> <span class="token punctuation">(</span>state<span class="token punctuation">,</span> <span class="token punctuation">{</span> posts <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=></span> adapter<span class="token punctuation">.</span><span class="token function">addMany</span><span class="token punctuation">(</span>posts<span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token operator">...</span>state<span class="token punctuation">,</span> selectedPostId<span class="token operator">:</span> <span class="token keyword">null</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">reducer</span><span class="token punctuation">(</span>state<span class="token operator">:</span> PostEntityState <span class="token operator">|</span> <span class="token keyword">undefined</span><span class="token punctuation">,</span> action<span class="token operator">:</span> Action<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token function">_postReducer</span><span class="token punctuation">(</span>state<span class="token punctuation">,</span> action<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></div>
<br>
<p><strong>store/post/post.action.ts</strong></p>
<div class="gatsby-highlight" data-language="typescript"><pre class="language-typescript"><code class="language-typescript"><span class="token keyword">import</span> <span class="token punctuation">{</span> createAction<span class="token punctuation">,</span> props <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@ngrx/store'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Post <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@app/models'</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> fetchPosts <span class="token operator">=</span> <span class="token function">createAction</span><span class="token punctuation">(</span><span class="token string">'[Post] Fetch Posts'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> selectPost <span class="token operator">=</span> <span class="token function">createAction</span><span class="token punctuation">(</span><span class="token string">'[Post] Select Post'</span><span class="token punctuation">,</span> <span class="token generic-function"><span class="token function">props</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token punctuation">{</span> id<span class="token operator">:</span> <span class="token builtin">number</span> <span class="token punctuation">}</span><span class="token operator">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> loadPosts <span class="token operator">=</span> <span class="token function">createAction</span><span class="token punctuation">(</span><span class="token string">'[Post] Load Posts'</span><span class="token punctuation">,</span> <span class="token generic-function"><span class="token function">props</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token punctuation">{</span> posts<span class="token operator">:</span> Post<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token operator">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<br>
<p><strong>store/post/post.selector.ts</strong></p>
<div class="gatsby-highlight" data-language="typescript"><pre class="language-typescript"><code class="language-typescript"><span class="token keyword">import</span> <span class="token punctuation">{</span> createFeatureSelector<span class="token punctuation">,</span> createSelector <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@ngrx/store'</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token punctuation">{</span> adapter<span class="token punctuation">,</span> <span class="token constant">POST_FEATURE_KEY</span><span class="token punctuation">,</span> PostEntityState <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./post.reducer'</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> selectPostState <span class="token operator">=</span> <span class="token generic-function"><span class="token function">createFeatureSelector</span><span class="token generic class-name"><span class="token operator">&lt;</span>PostEntityState<span class="token operator">></span></span></span><span class="token punctuation">(</span><span class="token constant">POST_FEATURE_KEY</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> selectIds<span class="token punctuation">,</span> selectAll<span class="token punctuation">,</span> selectEntities<span class="token punctuation">,</span> selectTotal <span class="token punctuation">}</span> <span class="token operator">=</span> adapter<span class="token punctuation">.</span><span class="token function">getSelectors</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> selectPostIds <span class="token operator">=</span> <span class="token function">createSelector</span><span class="token punctuation">(</span>selectPostState<span class="token punctuation">,</span> selectIds<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> selectPostEntities <span class="token operator">=</span> <span class="token function">createSelector</span><span class="token punctuation">(</span>selectPostState<span class="token punctuation">,</span> selectEntities<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> selectPostTotal <span class="token operator">=</span> <span class="token function">createSelector</span><span class="token punctuation">(</span>selectPostState<span class="token punctuation">,</span> selectTotal<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> selectAllPosts <span class="token operator">=</span> <span class="token function">createSelector</span><span class="token punctuation">(</span>selectPostState<span class="token punctuation">,</span> selectAll<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> selectCurrentPostId <span class="token operator">=</span> <span class="token function">createSelector</span><span class="token punctuation">(</span>selectPostState<span class="token punctuation">,</span> state <span class="token operator">=></span> state<span class="token punctuation">.</span>selectedPostId<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> selectCurrentPost <span class="token operator">=</span> <span class="token function">createSelector</span><span class="token punctuation">(</span>
  selectPostEntities<span class="token punctuation">,</span>
  selectCurrentPostId<span class="token punctuation">,</span>
  <span class="token punctuation">(</span>postEntities<span class="token punctuation">,</span> postId<span class="token punctuation">)</span> <span class="token operator">=></span> postEntities<span class="token punctuation">[</span>postId<span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<br>
<p><strong>store/post/post.effect.ts</strong></p>
<div class="gatsby-highlight" data-language="typescript"><pre class="language-typescript"><code class="language-typescript"><span class="token keyword">import</span> <span class="token punctuation">{</span> Injectable <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@angular/core'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Actions<span class="token punctuation">,</span> createEffect<span class="token punctuation">,</span> ofType <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@ngrx/effects'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> map<span class="token punctuation">,</span> mergeMapTo <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'rxjs/operators'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> PostService <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@app/services'</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token punctuation">{</span> fetchPosts<span class="token punctuation">,</span> loadPosts <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./post.action'</span><span class="token punctuation">;</span>

@<span class="token function">Injectable</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">PostEffects</span> <span class="token punctuation">{</span>
  fetchPostsEffect$ <span class="token operator">=</span> <span class="token function">createEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>action$<span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>
      <span class="token function">ofType</span><span class="token punctuation">(</span>fetchPosts<span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token function">mergeMapTo</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>postService<span class="token punctuation">.</span><span class="token function">getAllPost</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token function">map</span><span class="token punctuation">(</span>posts <span class="token operator">=></span> <span class="token function">loadPosts</span><span class="token punctuation">(</span><span class="token punctuation">{</span> posts <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">constructor</span><span class="token punctuation">(</span><span class="token keyword">private</span> action$<span class="token operator">:</span> Actions<span class="token punctuation">,</span> <span class="token keyword">private</span> postService<span class="token operator">:</span> PostService<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div>
<br>
<p><strong>store/post/post.module.ts</strong></p>
<div class="gatsby-highlight" data-language="typescript"><pre class="language-typescript"><code class="language-typescript"><span class="token keyword">import</span> <span class="token punctuation">{</span> CommonModule <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@angular/common'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> NgModule <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@angular/core'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> EffectsModule <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@ngrx/effects'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> StoreModule <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@ngrx/store'</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token punctuation">{</span> PostEffects <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./post.effect'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> <span class="token constant">POST_FEATURE_KEY</span><span class="token punctuation">,</span> reducer <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./post.reducer'</span><span class="token punctuation">;</span>

@<span class="token function">NgModule</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  imports<span class="token operator">:</span> <span class="token punctuation">[</span>
    CommonModule<span class="token punctuation">,</span>
    StoreModule<span class="token punctuation">.</span><span class="token function">forFeature</span><span class="token punctuation">(</span><span class="token constant">POST_FEATURE_KEY</span><span class="token punctuation">,</span> reducer<span class="token punctuation">)</span><span class="token punctuation">,</span>
    EffectsModule<span class="token punctuation">.</span><span class="token function">forFeature</span><span class="token punctuation">(</span><span class="token punctuation">[</span>PostEffects<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">PostFeatureStoreModule</span> <span class="token punctuation">{</span><span class="token punctuation">}</span></code></pre></div>
<br>
<p><strong>store/post/index.ts</strong></p>
<div class="gatsby-highlight" data-language="typescript"><pre class="language-typescript"><code class="language-typescript"><span class="token keyword">export</span> <span class="token operator">*</span> <span class="token keyword">from</span> <span class="token string">'./post.action'</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token operator">*</span> <span class="token keyword">from</span> <span class="token string">'./post.reducer'</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token operator">*</span> <span class="token keyword">from</span> <span class="token string">'./post.effect'</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token operator">*</span> <span class="token keyword">from</span> <span class="token string">'./post.selector'</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token operator">*</span> <span class="token keyword">from</span> <span class="token string">'./post.module'</span><span class="token punctuation">;</span></code></pre></div>
<br>
<p><strong>store/reducer.ts</strong></p>
<div class="gatsby-highlight" data-language="typescript"><pre class="language-typescript"><code class="language-typescript"><span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> fromPost <span class="token keyword">from</span> <span class="token string">'@store/entities/post'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> fromAuth <span class="token keyword">from</span> <span class="token string">'@store/application/auth'</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">interface</span> <span class="token class-name">State</span> <span class="token punctuation">{</span>
  <span class="token punctuation">[</span>fromPost<span class="token punctuation">.</span><span class="token constant">POST_FEATURE_KEY</span><span class="token punctuation">]</span><span class="token operator">:</span> fromPost<span class="token punctuation">.</span>PostEntityState<span class="token punctuation">;</span>
  <span class="token punctuation">[</span>fromAuth<span class="token punctuation">.</span><span class="token constant">AUTH_FEATURE_KEY</span><span class="token punctuation">]</span><span class="token operator">:</span> fromAuth<span class="token punctuation">.</span>AuthState<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token punctuation">{</span> fromPost<span class="token punctuation">,</span> fromAuth <span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre></div>
<br>
<p><strong>store/store.module.ts</strong></p>
<div class="gatsby-highlight" data-language="typescript"><pre class="language-typescript"><code class="language-typescript"><span class="token keyword">import</span> <span class="token punctuation">{</span> CommonModule <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@angular/common'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> NgModule <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@angular/core'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> EffectsModule <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@ngrx/effects'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> StoreModule <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@ngrx/store'</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token punctuation">{</span> PostFeatureStoreModule <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./entities/post'</span><span class="token punctuation">;</span>

@<span class="token function">NgModule</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  declarations<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  imports<span class="token operator">:</span> <span class="token punctuation">[</span>
    CommonModule<span class="token punctuation">,</span>
    StoreModule<span class="token punctuation">.</span><span class="token function">forRoot</span><span class="token punctuation">(</span>
      <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        runtimeChecks<span class="token operator">:</span> <span class="token punctuation">{</span>
          strictActionImmutability<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
          strictStateSerializability<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
          strictActionSerializability<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
          strictStateImmutability<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
          strictActionTypeUniqueness<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">)</span><span class="token punctuation">,</span>
    EffectsModule<span class="token punctuation">.</span><span class="token function">forRoot</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    PostFeatureStoreModule<span class="token punctuation">,</span>
    AuthFeatureStoreModule<span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">AppStoreModule</span> <span class="token punctuation">{</span><span class="token punctuation">}</span></code></pre></div>
<br>
<h4>Sử dụng @ngrx/component-store cho local state</h4>
<p>Với những state cần phải share trong app thì sẽ được quản lý bằng store. Nhưng sẽ có một số state chỉ được sử dụng bởi chính component đó thì <code class="language-text">@ngrx/component-store</code> sẽ là một sự lựa chọn cho ai thích áp dụng Reactive Programming trong Angular nhiều nhất có thể.</p>
<p>Một số lợi ích đó là:</p>
<ul>
<li>Tách biệt logic quản lý local state của component ra một service riêng.</li>
<li>Reactive hoàn toàn giúp đơn giản hơn trong việc kết hợp với các state khác bằng các operator của RxJS.</li>
<li>Tất cả logic về get, update state đều được thực hiện qua RxJS giúp được viết theo style declarative rất dễ hiểu (nếu người đọc cũng có nền tảng tốt về Functional Programming và Reactive Programming).</li>
</ul>
<h4>Tổng kết</h4>
<p>Về cơ bản thì trong angular chúng ta có thể phần chia code thành các module và khi sử dụng NgRx thì mình thường cho store là một module riêng. Module này sẽ được import vào App Module và load ngay từ đầu chứ không cần lazy load gì cả. </p>
<p>Structure đề nghị sẽ như thế này</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash"><span class="token builtin class-name">.</span>
├── app
│   ├── app-routing.module.ts
│   ├── app.module.ts
│   ├── features
│   │   ├── board
│   │   │   ├── board-routing.module.ts
│   │   │   ├── board.component.html
│   │   │   ├── board.component.scss
│   │   │   ├── board.component.ts
│   │   │   ├── board.module.ts
│   │   │   ├── header
│   │   │   │   ├── __snapshots__
│   │   │   │   │   └── header.component.spec.ts.snap
│   │   │   │   ├── header.component.html
│   │   │   │   ├── header.component.scss
│   │   │   │   ├── header.component.spec.ts
│   │   │   │   └── header.component.ts
│   │   │   └── index.ts
│   │   ├── login
│   │   │   ├── __snapshots__
│   │   │   ├── index.ts
│   │   │   ├── login-form
│   │   │   │   ├── __snapshots__
│   │   │   │   │   └── login-form.component.spec.ts.snap
│   │   │   │   ├── login-form.component.html
│   │   │   │   ├── login-form.component.scss
│   │   │   │   ├── login-form.component.spec.ts
│   │   │   │   ├── login-form.component.ts
│   │   │   │   └── login-form.store.ts
│   │   │   ├── login-routing.module.ts
│   │   │   ├── login.component.html
│   │   │   ├── login.component.scss
│   │   │   ├── login.component.ts
│   │   │   └── login.module.ts
│   │   └── posts
│   │       ├── __snapshots__
│   │       ├── index.ts
│   │       ├── post-detail
│   │       │   ├── __snapshots__
│   │       │   │   └── post-detail.component.spec.ts.snap
│   │       │   ├── post-detail.component.html
│   │       │   ├── post-detail.component.scss
│   │       │   ├── post-detail.component.spec.ts
│   │       │   └── post-detail.component.ts
│   │       ├── post-list
│   │       │   ├── __snapshots__
│   │       │   │   └── post-list.component.spec.ts.snap
│   │       │   ├── post-list.component.html
│   │       │   ├── post-list.component.scss
│   │       │   ├── post-list.component.spec.ts
│   │       │   └── post-list.component.ts
│   │       ├── posts-routing.module.ts
│   │       ├── posts.component.html
│   │       ├── posts.component.scss
│   │       ├── posts.component.ts
│   │       └── posts.module.ts
│   ├── guards
│   │   ├── auth.guard.spec.ts
│   │   ├── auth.guard.ts
│   │   ├── login.guard.spec.ts
│   │   └── login.guard.ts
│   ├── main
│   │   ├── __snapshots__
│   │   │   └── main.component.spec.ts.snap
│   │   ├── main.component.html
│   │   ├── main.component.scss
│   │   ├── main.component.spec.ts
│   │   └── main.component.ts
│   ├── models
│   │   ├── index.ts
│   │   ├── post.model.ts
│   │   └── user.model.ts
│   ├── services
│   │   ├── auth.service.ts
│   │   ├── index.ts
│   │   └── post.service.ts
│   └── store
│       ├── auth
│       │   ├── auth.action.ts
│       │   ├── auth.effect.ts
│       │   ├── auth.module.ts
│       │   ├── auth.reducer.ts
│       │   ├── auth.selector.ts
│       │   └── index.ts
│       ├── post
│       │   ├── index.ts
│       │   ├── post.action.ts
│       │   ├── post.effect.ts
│       │   ├── post.module.ts
│       │   ├── post.reducer.ts
│       │   └── post.selector.ts
│       ├── reducers.ts
│       └── store.module.ts
├── assets
├── environments
│   ├── environment.prod.ts
│   └── environment.ts
├── favicon.ico
├── index.html
├── main.ts
├── polyfills.ts
├── styles.scss
└── theme
    └── base.scss</code></pre></div></div></div></main></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/en/state-management-with-ngrx-in-angular";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-6fc754e12cb0264185f4.js"],"app":["/app-a42c45a4b4da4c1b5731.js"],"component---cache-caches-gatsby-plugin-offline-app-shell-js":["/component---cache-caches-gatsby-plugin-offline-app-shell-js-16703ee5599528db9f93.js"],"component---src-pages-index-tsx":["/component---src-pages-index-tsx-505fef4573c3bab4ea64.js"],"component---src-templates-blog-post-tsx":["/component---src-templates-blog-post-tsx-b4aef0ee06d6dd6721d3.js"]};/*]]>*/</script><script src="/blog/polyfill-6fc754e12cb0264185f4.js" nomodule=""></script><script src="/blog/component---src-templates-blog-post-tsx-b4aef0ee06d6dd6721d3.js" async=""></script><script src="/blog/022d3153bf09c36cd784dcdb36ffbd187f9c96d7-ab1bc4163aea950f629a.js" async=""></script><script src="/blog/app-a42c45a4b4da4c1b5731.js" async=""></script><script src="/blog/framework-d066f55745d479a55fde.js" async=""></script><script src="/blog/styles-8fab2804fb6f85b824b6.js" async=""></script><script src="/blog/webpack-runtime-c68adcef32857bd97904.js" async=""></script></body></html>